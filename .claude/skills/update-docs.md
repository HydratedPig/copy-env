---
name: update-docs
description: 在修改 src/ 目录下的文件后，会话结束前必须主动检查是否需要更新文档。适用于 API 变更、配置选项修改、新功能添加或 bug 修复等场景。
---

# 文档更新指令

## ⚠️ 重要：何时触发此 Skill

**你必须在以下情况下主动询问用户是否需要更新文档：**

1. **修改了 src/ 目录下的任何文件**（特别是 `.ts`, `.js` 文件）
2. **会话即将结束时**（用户说"好的"、"谢谢"、"完成了"等）
3. **完成了一个主要功能或修复后**

**触发步骤：**
1. 检测到上述情况时，使用 `AskUserQuestion` 工具询问用户
2. 提供明确的选项供用户选择
3. 根据用户选择执行相应操作

**询问方式（必须使用 AskUserQuestion 工具）：**
```typescript
AskUserQuestion({
  questions: [{
    question: '我注意到你修改了源代码（src/manager.ts），是否需要更新项目文档？',
    header: '更新文档',
    multiSelect: false,
    options: [
      {
        label: '是，立即更新',
        description: '更新所有多语言文档（README.md, docs/README.zh-CN.md 等）'
      },
      {
        label: '稍后手动更新',
        description: '本次跳过，稍后我会自己更新文档'
      },
      {
        label: '不需要',
        description: '本次修改是内部重构，不影响对外 API'
      }
    ]
  }]
});
```

**根据用户选择执行：**
- **"是，立即更新"**：立即执行完整的文档更新流程
- **"稍后手动更新"**：提示用户记得更新，并提供 `/update-docs` 命令
- **"不需要"**：记录用户决定，本次会话不再询问

---

## 文档更新流程

当源代码发生变更时，你需要更新项目的多语言文档，确保所有文档版本保持一致性和准确性。

## 工作流程

### 1. 分析代码变更

**首先检查是否有代码变更：**
```bash
git diff src/
```

识别变更类型并评估影响：
- **新增功能**：添加完整的功能说明和示例
- **修改 API**：更新相关的 API 文档和使用说明
- **配置变更**：更新配置选项说明和示例
- **Bug 修复**：更新已知问题或使用注意事项
- **重构代码**：检查是否影响对外 API，如无影响可跳过文档更新

**重要决策：**
- 如果只是内部重构（不影响 API），可以跳过文档更新
- 如果修改了公开的 API、配置选项或行为，**必须**更新文档

### 2. 更新文档
按以下顺序更新文档，保持各语言版本的内容结构一致：
1. README.md（英文主文档）
2. docs/README.zh-CN.md（简体中文）
3. docs/README.zh-TW.md（繁体中文）
4. docs/README.ja.md（日文）

### 3. 确保质量
- 代码示例必须可运行且与实际代码一致
- 配置示例必须准确反映当前 API
- Markdown 格式正确
- 保持文档风格一致

### 4. 完成后确认

更新完文档后，使用 `AskUserQuestion` 向用户确认：

```typescript
AskUserQuestion({
  questions: [{
    question: '文档已更新完成。更新的内容包括：\n- skipIfExists 参数的说明\n- 新的使用示例\n- 配置选项的描述\n\n请问是否需要进一步调整？',
    header: '文档更新',
    multiSelect: false,
    options: [
      {
        label: '看起来不错',
        description: '文档更新符合预期，无需修改'
      },
      {
        label: '需要调整',
        description: '我发现一些需要修改的地方'
      },
      {
        label: '让我检查一下',
        description: '我需要先查看更新的内容'
      }
    ]
  }]
});
```

**汇报格式（在询问前展示）：**
```
✅ 文档已更新完成

更新的文件：
- README.md
- docs/README.zh-CN.md
- docs/README.zh-TW.md
- docs/README.ja.md

主要更新内容：
- [具体列出修改的部分]

建议：运行 npm test 验证文档中的示例代码。
```

---

## 🔍 自动检测清单

在每次会话中，定期检查：
- [ ] 是否修改了 src/ 目录下的文件？
- [ ] 是否完成了主要功能或修复？
- [ ] 用户是否表示会话即将结束？
- [ ] 如果以上任一为真，是否已询问用户需要更新文档？
